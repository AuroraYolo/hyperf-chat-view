webpackJsonp([2],{"2Jft":function(t,e,s){"use strict";var i=s("COTu"),a={name:"group-notice",props:{groupId:{type:[String,Number],default:null}},data:function(){return{items:[],loadStatus:0}},created:function(){this.loadNotices()},methods:{loadNotices:function(){var t=this;this.loadStatus=0,Object(i.e)({group_id:this.groupId}).then(function(e){200==e.code?(t.items=e.data.map(function(t){return t.isShow=!1,t}),t.loadStatus=1):t.loadStatus=2}).catch(function(e){t.loadStatus=2})},catNoticeDetail:function(t){this.items[t].isShow=!this.items[t].isShow}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"base-mask"},[s("div",{staticClass:"container"},[s("el-container",{staticClass:"hv100"},[s("el-header",{staticClass:"padding0 header no-select",attrs:{height:"50px"}},[s("span",[t._v("群公告("+t._s(t.items.length)+")")]),t._v(" "),s("i",{staticClass:"close-btn el-icon-close",on:{click:function(e){return t.$emit("close")}}})]),t._v(" "),s("el-main",{staticClass:"main padding0"},[0==t.loadStatus?[s("div",{staticClass:"loading"},[s("div",{staticClass:"ant-spin ant-spin-lg ant-spin-spinning"},[s("span",{staticClass:"ant-spin-dot ant-spin-dot-spin"},[s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"})])]),t._v(" "),s("p",[t._v("正在努力加载中 ...")])])]:t._e(),t._v(" "),1==t.loadStatus&&0==t.items.length?[s("div",{staticClass:"loading"},[s("svg-icon",{staticStyle:{width:"60px",height:"60px"},attrs:{"icon-class":"not-data"}}),t._v(" "),s("p",[t._v("暂无群公告")])],1)]:t._e(),t._v(" "),2==t.loadStatus?[s("div",{staticClass:"loading"},[s("i",{staticClass:"el-icon-warning",staticStyle:{"font-size":"50px",color:"#ff5151"}}),t._v(" "),s("p",[t._v("加载失败， "),s("a",{staticClass:"pointer",on:{click:t.loadNotices}},[t._v("点击重试")]),t._v("...")])])]:[s("el-scrollbar",{staticClass:"hv100",attrs:{native:!1,tag:"section"}},t._l(t.items,function(e,i){return s("div",{key:e.id,staticClass:"notice-item"},[s("div",{staticClass:"title"},[s("span",{staticClass:"left-title",domProps:{textContent:t._s(e.title)}}),t._v(" "),s("span",{staticClass:"right-tools no-select",on:{click:function(e){return t.catNoticeDetail(i)}}},[t._v(t._s(e.isShow?"收起":"展开"))])]),t._v(" "),s("p",{staticClass:"datetime"},[s("el-avatar",{attrs:{size:15,src:e.avatar}},[s("img",{attrs:{src:"/static/image/detault-avatar.jpg",alt:""}})]),t._v(" "),s("span",{staticClass:"text nickname",domProps:{textContent:t._s(e.nickname)},on:{click:function(s){return t.$refs.userBusinessCard.open(e.user_id)}}}),t._v(" "),s("span",{staticClass:"text"},[t._v("发表于 "+t._s(e.created_at))])],1),t._v(" "),s("p",{staticClass:"content",class:{retract:!e.isShow},domProps:{textContent:t._s(e.content)}})])}),0)]],2)],1)],1)])},staticRenderFns:[]};var r=s("VU/8")(a,n,!1,function(t){s("Rgvn")},"data-v-23ab1a9c",null);e.a=r.exports},"5zde":function(t,e,s){s("zQR9"),s("qyJz"),t.exports=s("FeBl").Array.from},"9lK7":function(t,e,s){"use strict";s("E4LH");var i=s("Pi6f"),a=s("vMJZ"),n=(s("9NIY"),{name:"user-business-card",data:function(){return{isShow:!1,user_id:0,userInfo:{mobile:"",nickname:"",avatar:"",motto:"",friendStatus:0,friendApply:0,nicknameRemark:"",imgbag:"/static/image/default-user-banner.png",gender:0},editRemark:{isShow:!1,text:""},applyFrom:{isShow:!1,text:""}}},methods:{open:function(t){this.isShow=!0,this.user_id=t,this.findUserDetail()},close:function(){this.isShow=!1},mobile:function(t){return t.substr(0,3)+" "+t.substr(3,4)+" "+t.substr(7,4)},clickEditRemark:function(){this.editRemark.isShow=!0,this.editRemark.text=this.userInfo.nicknameRemark},findUserDetail:function(){var t=this;Object(a.t)({user_id:this.user_id}).then(function(e){if(200==e.code){var s=e.data;t.userInfo.user_id=s.id,t.userInfo.mobile=s.mobile,t.userInfo.nickname=s.nickname,t.userInfo.nicknameRemark=s.nickname_remark,t.userInfo.motto=s.motto,t.userInfo.avatar=s.avatar,t.userInfo.friendStatus=s.friend_status,t.userInfo.friendApply=s.friend_apply,t.userInfo.gender=s.gender}})},sendApply:function(){var t=this;""!=this.applyFrom.text&&Object(a.l)({friend_id:this.userInfo.user_id,remarks:this.applyFrom.text}).then(function(e){200==e.code?(t.applyFrom.isShow=!1,t.applyFrom.text="",t.userInfo.friendApply=1):alert("发送好友申请失败,请稍后再试...")})},editRemarkSubmit:function(){var t=this,e={friend_id:this.userInfo.user_id,remarks:this.editRemark.text};e.remarks!=this.userInfo.nicknameRemark?Object(a.m)(e).then(function(s){200==s.code&&(t.editRemark.isShow=!1,t.userInfo.nicknameRemark=e.remarks,t.$emit("changeRemark",e))}):this.editRemark.isShow=!1},closeApplyFrom:function(){this.applyFrom.isShow=!1},sendMessage:function(){var t=this,e=this.userInfo;Object(i.a)({type:1,receive_id:this.user_id}).then(function(s){200===s.code&&t.$root.dumpTalkPage("1_"+e.user_id)})}}}),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"base-mask animated fadeIn"},[s("el-container",{directives:[{name:"outside",rawName:"v-outside",value:t.close,expression:"close"}],staticClass:"container"},[s("el-header",{staticClass:"padding0 header",attrs:{height:"180px"}},[s("i",{staticClass:"el-icon-error close-icon",on:{click:t.close}}),t._v(" "),s("div",{staticClass:"img-banner"},[s("img",{staticClass:"img-banner",attrs:{src:t.userInfo.imgbag,alt:""}})]),t._v(" "),s("div",{staticClass:"user-header"},[s("div",{staticClass:"avatar"},[s("div",{staticClass:"avatar-box"},[s("img",{attrs:{src:t.userInfo.avatar,onerror:t.$store.state.detaultAvatar,alt:""}})])]),t._v(" "),s("div",{staticClass:"nickname"},[s("i",{staticClass:"iconfont icon-qianming"}),t._v(" "),s("span",[t._v(t._s(t.userInfo.nickname||"未设置昵称"))])])])]),t._v(" "),s("el-main",{staticClass:"padding0 main"},[s("div",{staticClass:"user-sign"},[s("div",{staticClass:"sign-arrow"}),t._v(" "),s("i",{staticClass:"iconfont icon-bianji"}),t._v(" "),s("span",[t._v("编辑个签，展示我的独特态度。\n        ")])]),t._v(" "),s("div",{staticClass:"card-rows no-select"},[s("div",{staticClass:"card-row"},[s("label",[t._v("手机")]),t._v(" "),s("span",[t._v(t._s(t.mobile(t.userInfo.mobile))+" ")])]),t._v(" "),s("div",{staticClass:"card-row"},[s("label",[t._v("昵称")]),t._v(" "),s("span",[t._v(t._s(t.userInfo.nickname||"未设置昵称"))])]),t._v(" "),s("div",{staticClass:"card-row"},[s("label",[t._v("性别")]),t._v(" "),1==t.userInfo.gender?s("span",[t._v("男")]):2==t.userInfo.gender?s("span",[t._v("女")]):s("span",[t._v("未知")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.userInfo.friendStatus,expression:"userInfo.friendStatus == 2"}],staticClass:"card-row"},[s("label",[t._v("备注")]),t._v(" "),t.editRemark.isShow?s("span",[s("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.editRemark.text,expression:"editRemark.text"}],staticClass:"friend-remark",attrs:{type:"text"},domProps:{value:t.editRemark.text},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.editRemarkSubmit(e)},input:function(e){e.target.composing||t.$set(t.editRemark,"text",e.target.value)}}})]):s("span",[t._v(t._s(t.userInfo.nicknameRemark?t.userInfo.nicknameRemark:"暂无备注"))]),t._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:!t.editRemark.isShow,expression:"!editRemark.isShow"}],staticClass:"el-icon-edit-outline",on:{click:t.clickEditRemark}})]),t._v(" "),s("div",{staticClass:"card-row"},[s("label",[t._v("邮箱")]),t._v(" "),s("span",[t._v("未设置")])])])]),t._v(" "),s("el-footer",{directives:[{name:"show",rawName:"v-show",value:0!==t.userInfo.friendStatus,expression:"userInfo.friendStatus !== 0"}],staticClass:"padding0 footer",attrs:{height:"50px"}},[1==t.userInfo.friendStatus&&0==t.userInfo.friendApply?s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(e){t.applyFrom.isShow=!0}}},[t._v("添加好友")]):1==t.userInfo.friendApply?s("el-button",{attrs:{type:"primary",size:"small"}},[t._v("已发送好友申请，请耐心等待...")]):s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-s-promotion"},on:{click:function(e){return t.sendMessage(t.userInfo)}}},[t._v("发消息\n      ")])],1),t._v(" "),s("div",{directives:[{name:"outside",rawName:"v-outside",value:t.closeApplyFrom,expression:"closeApplyFrom"}],staticClass:"friend-from",class:{"friend-from-show":t.applyFrom.isShow}},[s("p",[s("span",[t._v("请填写好友申请备注：")]),t._v(" "),s("span",{on:{click:t.closeApplyFrom}},[t._v("取消")])]),t._v(" "),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.applyFrom.text,expression:"applyFrom.text"}],attrs:{type:"text",placeholder:"(必填项)"},domProps:{value:t.applyFrom.text},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendApply(e)},input:function(e){e.target.composing||t.$set(t.applyFrom,"text",e.target.value)}}}),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.sendApply}},[t._v("立即提交")])],1)])],1)],1)},staticRenderFns:[]};var o=s("VU/8")(n,r,!1,function(t){s("Yfuw")},"data-v-76dffcf6",null);e.a=o.exports},BtDC:function(t,e,s){"use strict";var i=s("Gu7T"),a=s.n(i),n=s("woOf"),r=s.n(n),o=s("COTu"),c=s("9NIY"),l={name:"launch-group-chat",props:{groupId:{type:[String,Number],default:null}},data:function(){return{readonly:!1,from:{groupId:0,groupName:""},contacts:[],search:[],keywords:"",isAvatarCropper:!1}},computed:{selected:function(){return this.contacts.filter(function(t,e){return t.checked})}},watch:{keywords:function(t){var e=this;this.search=""==t?this.contacts:this.contacts.filter(function(t,s){return null!=t.nickname.match(e.keywords)})},contacts:function(t){""==this.keywords&&(this.search=t)}},created:function(){this.groupId>0&&(this.readonly=!0,this.from.groupId=this.groupId),this.friendsApi()},mounted:function(){this.handleScroll()},methods:{triggerContacts:function(t){var e=this.contacts.findIndex(function(e){return e.id==t.id});this.contacts[e].checked=!this.contacts[e].checked},delContacts:function(t){var e=this.contacts.findIndex(function(e){return e.id==t.id});this.contacts[e].checked=!1},delAll:function(){var t=this;this.contacts.forEach(function(e,s){t.contacts[s].checked=!1})},close:function(){this.$emit("close")},getIds:function(){return this.selected.map(function(t){return t.id})},friendsApi:function(){var t=this;Object(o.f)({group_id:this.from.groupId}).then(function(e){if(200==e.code&&e.data){var s;t.contacts=[];var i=e.data.map(function(t){return r()(t,{nickname:t.friend_remark?t.friend_remark:t.nickname,checked:!1})});(s=t.contacts).push.apply(s,a()(i))}}).catch(function(t){console.log(t)})},createSubmit:function(){var t=this,e={group_avatar:"",group_name:this.from.groupName,group_profile:"",uids:this.getIds().join(",")};""!=e.group_name?this.getIds().length<2?this.$message("群聊人数必须大于俩人"):Object(o.a)(e).then(function(e){200==e.code?t.$emit("create-success",e.data):t.$message("创建群聊失败")}):this.$message("群聊名称不能为空")},inviteSubmit:function(){var t=this;Object(o.h)({group_id:this.from.groupId,uids:this.getIds().join(",")}).then(function(e){200==e.code?t.$emit("invite-success"):t.$message("邀请好友失败")})},handleScroll:function(){var t=this.$refs.scrollbar.wrap;t.onscroll=function(){var e=document.getElementById("search-header");0==t.scrollTop?Object(c.l)(e,"search-header-shadow"):Object(c.a)(e,"search-header-shadow")}}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"base-mask"},[s("div",{directives:[{name:"outside",rawName:"v-outside",value:t.close,expression:"close"}],staticClass:"container"},[s("el-container",{staticClass:"hv100"},[s("el-header",{staticClass:"padding0 header no-select",attrs:{height:"50px"}},[s("p",[s("span",[t._v(t._s(0==t.from.groupId?"创建群组":"请选择需要邀请的好友"))])]),t._v(" "),s("i",{staticClass:"close-btn el-icon-close",on:{click:t.close}})]),t._v(" "),s("el-main",{staticClass:"main padding0"},[s("el-container",{staticClass:"hv100"},[s("el-aside",{staticClass:"aside-border",attrs:{width:"250px"}},[s("el-container",{staticClass:"hv100 no-select"},[s("el-header",{staticClass:"padding0 search-header",attrs:{height:"50px",id:"search-header"}},[s("el-input",{attrs:{placeholder:"搜索 | 好友 or 群组","prefix-icon":"el-icon-search",clearable:"",size:"small"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),t._v(" "),s("el-main",{staticClass:"padding0"},[s("el-scrollbar",{ref:"scrollbar",staticClass:"hv100",attrs:{native:!1,tag:"section"}},[s("ul",{staticClass:"friend-items no-select"},t._l(t.search,function(e,i){return s("li",{key:e.id,on:{click:function(s){return t.triggerContacts(e)}}},[s("el-avatar",{staticClass:"avatar",staticStyle:{"margin-top":"5px"},attrs:{size:25,src:e.avatar}},[s("img",{attrs:{src:"/static/image/detault-avatar.jpg"}})]),t._v(" "),s("span",{staticClass:"nickname"},[t._v(t._s(e.nickname))]),t._v(" "),s("span",{staticClass:"select-btn"},[s("i",{staticClass:"el-icon-success",class:{"i-color-green":e.checked}})])],1)}),0)])],1)],1)],1),t._v(" "),s("el-main",{staticClass:"padding0"},[s("el-container",{staticClass:"hv100"},[s("el-header",{directives:[{name:"show",rawName:"v-show",value:!t.readonly,expression:"!readonly"}],attrs:{height:"50px"}},[s("div",{staticClass:"group-from no-select"},[s("label",[t._v("群名称")]),t._v(" "),s("p",[s("el-input",{attrs:{placeholder:"请输入群名称(必填)",size:"small"},model:{value:t.from.groupName,callback:function(e){t.$set(t.from,"groupName",e)},expression:"from.groupName"}})],1)])]),t._v(" "),s("el-header",{class:{mt40:!t.readonly},attrs:{height:"40px"}},[s("el-divider",{staticClass:"no-select",attrs:{"content-position":"left"}},[s("span",{staticStyle:{color:"#c4c5c7"}},[t._v("邀请成员 ("+t._s(t.selected.length)+")")])])],1),t._v(" "),s("el-main",[s("el-scrollbar",{staticClass:"hv100",attrs:{native:!1,tag:"section"}},[s("div",{staticClass:"selectd-items"},t._l(t.selected,function(e,i){return s("div",{key:e.id,staticClass:"selectd-item no-select"},[s("el-avatar",{attrs:{size:25,src:e.avatar}},[s("img",{attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}})]),t._v(" "),s("p",[t._v(t._s(e.nickname))]),t._v(" "),s("div",{staticClass:"triangle-topleft",class:{"triangle-topleft-group":2==e.type}}),t._v(" "),s("div",{staticClass:"del-mask",on:{click:function(s){return t.delContacts(e)}}},[s("i",{staticClass:"el-icon-delete"})])],1)}),0)])],1)],1)],1)],1)],1),t._v(" "),s("el-footer",{staticClass:"padding0 footer",attrs:{height:"50px"}},[s("el-button",{attrs:{size:"small",plain:""},on:{click:t.close}},[t._v("取消")]),t._v(" "),0==t.from.groupId?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.createSubmit}},[t._v("\n          创建群组"),s("span",{directives:[{name:"show",rawName:"v-show",value:t.selected.length,expression:"selected.length"}]},[t._v("("+t._s(t.selected.length)+")")])]):s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.inviteSubmit}},[t._v("\n          立即邀请("+t._s(t.selected.length)+")\n        ")])],1)],1)],1)])},staticRenderFns:[]};var d=s("VU/8")(l,u,!1,function(t){s("srYc")},"data-v-15456be6",null);e.a=d.exports},COTu:function(t,e,s){"use strict";s.d(e,"g",function(){return a}),s.d(e,"a",function(){return n}),s.d(e,"b",function(){return r}),s.d(e,"h",function(){return o}),s.d(e,"i",function(){return c}),s.d(e,"j",function(){return l}),s.d(e,"k",function(){return u}),s.d(e,"f",function(){return d}),s.d(e,"d",function(){return p}),s.d(e,"e",function(){return m}),s.d(e,"c",function(){return v});var i=s("vLgD"),a=function(t){return Object(i.a)("/api/group/detail",t)},n=function(t){return Object(i.b)("/api/group/create",t)},r=function(t){return Object(i.b)("/api/group/edit",t)},o=function(t){return Object(i.b)("/api/group/invite",t)},c=function(t){return Object(i.b)("/api/group/remove-members",t)},l=function(t){return Object(i.b)("/api/group/secede",t)},u=function(t){return Object(i.b)("/api/group/set-group-card",t)},d=function(t){return Object(i.a)("/api/group/invite-friends",t)},p=function(t){return Object(i.a)("/api/group/members",t)},m=function(t){return Object(i.a)("/api/group/notices",t)},v=function(t){return Object(i.b)("/api/group/edit-notice",t)}},"EGC/":function(t,e){},Gu7T:function(t,e,s){"use strict";e.__esModule=!0;var i,a=s("c/Tr"),n=(i=a)&&i.__esModule?i:{default:i};e.default=function(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return(0,n.default)(t)}},Pi6f:function(t,e,s){"use strict";s.d(e,"b",function(){return a}),s.d(e,"a",function(){return n}),s.d(e,"e",function(){return r}),s.d(e,"p",function(){return o}),s.d(e,"d",function(){return c}),s.d(e,"c",function(){return l}),s.d(e,"j",function(){return u}),s.d(e,"i",function(){return d}),s.d(e,"g",function(){return p}),s.d(e,"h",function(){return m}),s.d(e,"o",function(){return v}),s.d(e,"f",function(){return f}),s.d(e,"l",function(){return h}),s.d(e,"n",function(){return _}),s.d(e,"k",function(){return g}),s.d(e,"m",function(){return b});var i=s("vLgD"),a=function(t){return Object(i.a)("/api/talk/list",t)},n=function(t){return Object(i.b)("/api/talk/create",t)},r=function(t){return Object(i.b)("/api/talk/delete",t)},o=function(t){return Object(i.b)("/api/talk/topping",t)},c=function(t){return Object(i.b)("/api/talk/update-unread-num",t)},l=function(t){return Object(i.a)("/api/talk/records",t)},u=function(t){return Object(i.b)("/api/talk/revoke-records",t)},d=function(t){return Object(i.b)("/api/talk/remove-records",t)},p=function(t){return Object(i.b)("/api/talk/forward-records",t)},m=function(t){return Object(i.a)("/api/talk/get-forward-records",t)},v=function(t){return Object(i.b)("/api/talk/set-not-disturb",t)},f=function(t){return Object(i.a)("/api/talk/find-chat-records",t)},h=function(t){return Object(i.b)("/api/talk/send-code-block",t)},_=function(t){return Object(i.b)("/api/talk/send-file",t)},g=function(t){return Object(i.c)("/api/talk/send-image",t)},b=function(t){return Object(i.b)("/api/talk/send-emoticon",t)}},Rgvn:function(t,e){},Y3Hk:function(t,e,s){"use strict";var i=s("vMJZ"),a={name:"search-users",components:{UserBusinessCard:s("9lK7").a},data:function(){return{loading:!1,isShow:!1,input:"",isError:!1}},methods:{open:function(){this.isShow=!0},close:function(){this.isShow=!1},onSubmit:function(){var t=this;if(""==this.input)return!1;this.loading=!0,Object(i.t)({mobile:this.input}).then(function(e){200==e.code?(t.$refs.userBusinessCard.open(e.data.id),t.close()):t.isError=!0,t.loading=!1}).catch(function(e){t.loading=!1})}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"base-mask"},[s("div",{directives:[{name:"outside",rawName:"v-outside",value:t.close,expression:"close"}],staticClass:"container"},[s("el-container",{staticClass:"hv100"},[s("el-header",{staticClass:"padding0 header",attrs:{height:"50px"}},[s("span",[t._v("添加好友")]),t._v(" "),s("i",{staticClass:"close-btn el-icon-close",on:{click:t.close}})]),t._v(" "),s("el-main",{staticClass:"main"},[s("el-input",{staticClass:"input",staticStyle:{"text-align":"center"},attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入对方手机号(精确查找)",clearable:""},on:{input:function(e){t.isError=!1}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit(e)}},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.isError,expression:"isError"}],staticClass:"error"},[t._v("无法找到该用户，请检查搜索内容并重试")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small",loading:t.loading},on:{click:t.onSubmit}},[t._v("立即查找")])],1)],1)],1)]),t._v(" "),s("user-business-card",{ref:"userBusinessCard"})],1)},staticRenderFns:[]};var r=s("VU/8")(a,n,!1,function(t){s("EGC/")},"data-v-a80b349e",null);e.a=r.exports},Yfuw:function(t,e){},"c/Tr":function(t,e,s){t.exports={default:s("5zde"),__esModule:!0}},fBQ2:function(t,e,s){"use strict";var i=s("evD5"),a=s("X8DO");t.exports=function(t,e,s){e in t?i.f(t,e,a(0,s)):t[e]=s}},fcc9:function(t,e){},"g+1g":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("bIDK"),a=s("BtDC"),n=s("9lK7"),r=s("Y3Hk"),o=s("vm2t"),c=s("vMJZ"),l=s("COTu"),u=s("Pi6f"),d={name:"contacts-page",components:{MainLayout:i.a,LaunchGroupChat:a.a,UserBusinessCard:n.a,SearchUsers:r.a,UserGroup:o.a},data:function(){return{launchGroupShow:!1,input:"",subMenu:!1,activeIndex:0,apply:{items:[],status:0},friends:{items:[],status:0},groups:{items:[],status:0},groupDetailId:0}},computed:{waitHandleNum:function(){return this.apply.items.filter(function(t){return 0==t.status}).length}},created:function(){this.loadFriendApply()},methods:{closeSubMenu:function(){this.subMenu=!1},triggerSubMenu:function(t){this.closeSubMenu(),1==t?this.launchGroupShow=!0:this.$refs.searchUsers.open()},triggerMenu:function(t){this.activeIndex=t,1==t?0==this.friends.status&&this.loadFriends():2==t&&0==this.groups.status&&this.loadUserGroups(),2!=t&&(this.groupDetailId=0)},loadFriendApply:function(){var t=this;Object(c.g)({page:1,page_size:1e4}).then(function(e){200==e.code&&(t.apply.status=1,t.apply.items=e.data.rows)})},loadFriends:function(){var t=this;Object(c.n)().then(function(e){200==e.code&&(t.friends.status=1,t.friends.items=e.data)})},loadUserGroups:function(){var t=this;Object(c.i)().then(function(e){200==e.code&&(t.groups.status=1,t.groups.items=e.data)})},openUserDetail:function(t){this.$refs.userBusinessCard.open(t)},toTalk:function(t,e){var s=this,i=e.split("_")[1];Object(u.a)({type:t,receive_id:i}).then(function(t){200===t.code&&s.$root.dumpTalkPage(e)})},groupChatSuccess:function(t){this.launchGroupShow=!1,this.loadUserGroups()},disturbChange:function(t){var e=this.getGroupIndex(t.group_id);this.groups.items[e].not_disturb=t.status},getGroupIndex:function(t){return this.groups.items.findIndex(function(e,s,i){return e.id==t})},sendMessage:function(t){this.toTalk(2,"2_"+t)},quitGroupSuccess:function(){this.$delete(this.groups.items,this.getGroupIndex(this.groupDetailId)),this.groupDetailId=0},handleFrom:function(t){var e=this;this.$prompt("请设置好友备注【"+t.nickname+"】","好友备注",{confirmButtonText:"确定",cancelButtonText:"取消",customClass:"border-radius0",inputValidator:function(t){return null!=t&&""!=t||"好友备注不能为空"}}).then(function(s){Object(c.o)({apply_id:t.id,remarks:s.value}).then(function(s){if(200==s.code){var i=t.id,a=e.apply.items.findIndex(function(t){return t.id==i});e.apply.items[a].status=1,e.$message({message:"处理成功...",type:"success"})}else e.$message({type:"info",message:"提交失败"})})}).catch(function(t){})},deleteFriendApply:function(t){var e=this,s=t.id;Object(c.a)({apply_id:s}).then(function(t){200==t.code&&e.$delete(e.apply.items,e.apply.items.findIndex(function(t){return t.id==s}))})},deleteFriend:function(t){var e=this,s=t.friend_remark?t.friend_remark:t.name;this.$alert("您确定要删除【"+s+"】好友吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,customClass:"border-radius0",closeOnClickModal:!0,callback:function(i){if("confirm"==i){var a=t.id;Object(c.s)({friend_id:a}).then(function(t){200==t.code?(e.$delete(e.friends.items,e.friends.items.findIndex(function(t){return t.id==a})),e.$message({message:"好友 【"+s+"】已删除 ...",type:"success"})):e.$message({message:"好友 【"+s+"】删除失败 ...",type:"info"})})}}})},deleteGroup:function(t){var e=this;this.$alert("您确定要退出【"+t.group_name+"】群聊吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,customClass:"border-radius0",closeOnClickModal:!0,callback:function(s){if("confirm"==s){var i=t.id;Object(l.j)({group_id:i}).then(function(s){200==s.code?(e.$delete(e.groups.items,e.groups.items.findIndex(function(t){return t.id==i})),e.$message({message:"您已成功退出【"+t.group_name+"】群聊 ...",type:"success"})):e.$message({message:"退出 【"+t.group_name+"】】群聊失败 ...",type:"info"})})}}})},changeRemark:function(t){var e=this.friends.items.findIndex(function(e){return e.id==t.friend_id});e>=0&&(this.friends.items[e].friend_remark=t.remarks)}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("main-layout",{attrs:{idx:1}},[s("el-container",{staticClass:"hv100",attrs:{slot:"container"},slot:"container"},[s("el-aside",{staticClass:"aside-box padding0",attrs:{width:"250px"}},[s("el-container",{staticClass:"hv100",attrs:{direction:"vertical"}},[s("el-header",{staticClass:"padding0 header",attrs:{height:"60px"}},[s("div",{staticClass:"from"},[s("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"搜索好友 / 群组",size:"small"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1),t._v(" "),s("div",{staticClass:"tools"},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:t.subMenu,expression:"subMenu"}],attrs:{icon:"el-icon-plus",circle:"",plain:"",size:"small"}}),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.subMenu,expression:"!subMenu"}],attrs:{icon:"el-icon-plus",circle:"",plain:"",size:"small"},on:{click:function(e){t.subMenu=!0}}}),t._v(" "),s("transition",{attrs:{name:"el-zoom-in-top"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.subMenu,expression:"subMenu"},{name:"outside",rawName:"v-outside",value:t.closeSubMenu,expression:"closeSubMenu"}],staticClass:"tools-menu"},[s("div",{staticClass:"menu1-item",on:{click:function(e){return t.triggerSubMenu(1)}}},[t._v("创建群组")]),t._v(" "),s("div",{staticClass:"menu1-item",on:{click:function(e){return t.triggerSubMenu(2)}}},[t._v("添加好友")])])])],1)]),t._v(" "),s("el-main",{staticClass:"padding0 main no-select"},[s("div",{staticClass:"menu-item",class:{"menu-item-border":0==t.activeIndex},on:{click:function(e){return t.triggerMenu(0)}}},[s("span",[t._v("新的联系人")])]),t._v(" "),s("div",{staticClass:"menu-item",class:{"menu-item-border":1==t.activeIndex},on:{click:function(e){return t.triggerMenu(1)}}},[s("span",[t._v("我的好友")])]),t._v(" "),s("div",{staticClass:"menu-item",class:{"menu-item-border":2==t.activeIndex},on:{click:function(e){return t.triggerMenu(2)}}},[s("span",[t._v("我的群组")])])])],1)],1),t._v(" "),s("el-container",{staticClass:"padding0 hv100 ov-hidden panel"},[s("el-header",{staticClass:"panel-header no-select",attrs:{height:"60px"}},[0==t.activeIndex?[s("p",[t._v("新的联系人")]),t._v(" "),s("p",[s("span",{directives:[{name:"show",rawName:"v-show",value:t.waitHandleNum,expression:"waitHandleNum"}],staticClass:"wait-handle-btn"},[t._v("\n                【"+t._s(t.waitHandleNum)+"】待处理\n                "),s("i",{staticClass:"el-icon-warning"})])])]:1==t.activeIndex?[s("p",[t._v("我的好友("+t._s(t.friends.items.length)+")")]),t._v(" "),s("p",{staticClass:"pointer",on:{click:function(e){return t.$refs.searchUsers.open()}}},[s("i",{staticClass:"el-icon-plus"}),t._v(" "),s("span",[t._v("添加好友")])])]:2==t.activeIndex?[s("p",[t._v("我的群组("+t._s(t.groups.items.length)+")")]),t._v(" "),s("p",{staticClass:"pointer",on:{click:function(e){t.launchGroupShow=!0}}},[s("i",{staticClass:"el-icon-plus"}),t._v(" "),s("span",[t._v("创建群组")])])]:t._e()],2),t._v(" "),s("el-main",{staticClass:"panel-main lm-scrollbar"},[0==t.activeIndex?[0==t.apply.status?[s("div",{staticClass:"preloading"},[s("div",{staticClass:"ant-spin ant-spin-lg ant-spin-spinning"},[s("span",{staticClass:"ant-spin-dot ant-spin-dot-spin"},[s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"})])]),t._v(" "),s("p",[t._v("数据加载中 ...")])])]:t._e(),t._v(" "),1==t.apply.status?[0==t.apply.items.length?[s("div",{staticClass:"preloading",staticStyle:{height:"50%"}},[s("img",{attrs:{src:"/static/image/no-oncall.6b776fcf.png",width:"180"}}),t._v(" "),s("p",[t._v("暂无联系人申请")])])]:t._e(),t._v(" "),t._l(t.apply.items,function(e,i){return s("div",{key:e.id,staticClass:"data-item",on:{click:function(s){return t.openUserDetail(e.user_id)}}},[s("el-avatar",{staticClass:"avatar",attrs:{shape:"square",size:35,src:e.avatar}},[t._v("\n                    "+t._s(e.nickname.substr(0,1))+"\n                  ")]),t._v(" "),s("div",{staticClass:"card"},[s("div",{staticClass:"title"},[s("span",{staticClass:"name"},[t._v(t._s(e.nickname))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0==e.status,expression:"item.status == 0"}],staticClass:"larkc-tag wait"},[t._v("待处理")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.status,expression:"item.status == 1"}],staticClass:"larkc-tag agree"},[t._v("已同意")])]),t._v(" "),s("div",{staticClass:"content"},[t._v("[申请时间] "+t._s(e.created_at)+" ~ [备注说明] "+t._s(e.remarks))])]),t._v(" "),s("div",{staticClass:"apply-from",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.status,expression:"item.status == 0"}],attrs:{size:"mini",type:"primary",icon:"el-icon-check"},on:{click:function(s){return t.handleFrom(e)}}},[t._v("同意申请\n                    ")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.status,expression:"item.status == 1"}],attrs:{size:"mini",type:"primary",icon:"el-icon-s-promotion"},on:{click:function(s){return t.toTalk(1,"1_"+e.id)}}},[t._v("发送消息")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return t.deleteFriendApply(e)}}},[t._v("删除记录\n                    ")])],1)],1)})]:t._e()]:1==t.activeIndex?[0==t.friends.status?[s("div",{staticClass:"preloading"},[s("div",{staticClass:"ant-spin ant-spin-lg ant-spin-spinning"},[s("span",{staticClass:"ant-spin-dot ant-spin-dot-spin"},[s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"})])]),t._v(" "),s("p",[t._v("数据加载中 ...")])])]:t._e(),t._v(" "),1==t.friends.status?[0==t.friends.items.length?[s("div",{staticClass:"preloading"},[s("img",{attrs:{src:"/static/image/no-oncall.6b776fcf.png",width:"180"}}),t._v(" "),s("p",[t._v("暂无好友")])])]:t._e(),t._v(" "),t._l(t.friends.items,function(e,i){return s("div",{key:e.id,staticClass:"data-item",on:{click:function(s){return t.openUserDetail(e.id)}}},[s("el-avatar",{staticClass:"avatar",attrs:{shape:"square",size:35,src:e.avatar}},[t._v("\n                    "+t._s(e.nickname.substr(0,1))+"\n                  ")]),t._v(" "),s("div",{staticClass:"card"},[s("div",{staticClass:"title"},[s("span",{staticClass:"name"},[t._v(t._s(e.friend_remark?e.friend_remark:e.nickname))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.online,expression:"item.online == 1"}],staticClass:"larkc-tag agree"},[t._v("在线")])]),t._v(" "),s("div",{staticClass:"content"},[t._v("[个性签名] 「"+t._s(e.motto?e.motto:"未设置")+"」")])]),t._v(" "),s("div",{staticClass:"apply-from",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-s-promotion"},on:{click:function(s){return t.toTalk(1,"1_"+e.id)}}},[t._v("发送消息")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return t.deleteFriend(e)}}},[t._v("删除好友\n                    ")])],1)],1)})]:t._e()]:2==t.activeIndex?[0==t.groups.status?[s("div",{staticClass:"preloading"},[s("div",{staticClass:"ant-spin ant-spin-lg ant-spin-spinning"},[s("span",{staticClass:"ant-spin-dot ant-spin-dot-spin"},[s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"}),t._v(" "),s("i",{staticClass:"ant-spin-dot-item"})])]),t._v(" "),s("p",[t._v("数据加载中 ...")])])]:t._e(),t._v(" "),1==t.groups.status?[0==t.groups.items.length?[s("div",{staticClass:"preloading"},[s("img",{attrs:{src:"/static/image/no-oncall.6b776fcf.png",width:"180"}}),t._v(" "),s("p",[t._v("暂未加入群聊")])])]:t._e(),t._v(" "),t._l(t.groups.items,function(e,i){return s("div",{key:e.id,staticClass:"data-item",on:{click:function(s){t.groupDetailId=e.id}}},[s("el-avatar",{staticClass:"avatar",attrs:{shape:"square",size:35,src:e.avatar}},[t._v("\n                    "+t._s(e.group_name.substr(0,1))+"\n                  ")]),t._v(" "),s("div",{staticClass:"card"},[s("div",{staticClass:"title"},[s("span",{staticClass:"name"},[t._v(t._s(e.group_name))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1==e.not_disturb,expression:"item.not_disturb == 1"}],staticClass:"larkc-tag"},[s("i",{staticClass:"iconfont icon-xiaoximiandarao",staticStyle:{"font-size":"10px",color:"#7d7a7a"}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isGroupLeader,expression:"item.isGroupLeader"}],staticClass:"larkc-tag wait"},[t._v("群主")])]),t._v(" "),s("div",{staticClass:"content"},[t._v("[群介绍] ~ 「"+t._s(e.group_profile?e.group_profile:"未设置")+"」")]),t._v(" "),s("div",{staticClass:"apply-from",on:{click:function(t){t.preventDefault(),t.stopPropagation()}}},[s("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-s-promotion"},on:{click:function(s){return t.toTalk(2,"2_"+e.id)}}},[t._v("发送消息")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return t.deleteGroup(e)}}},[t._v("退出群聊\n                      ")])],1)])],1)})]:t._e()]:t._e()],2),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.groupDetailId,expression:"groupDetailId"}],staticClass:"broadside-box"},[s("user-group",{attrs:{"group-id":t.groupDetailId},on:{close:function(e){t.groupDetailId=0},"send-group":t.sendMessage,"disturb-change":t.disturbChange,"quit-group":t.quitGroupSuccess}})],1)],1)],1)],1),t._v(" "),t.launchGroupShow?s("launch-group-chat",{on:{close:function(e){t.launchGroupShow=!1},"create-success":t.groupChatSuccess}}):t._e(),t._v(" "),s("user-business-card",{ref:"userBusinessCard",on:{changeRemark:t.changeRemark}}),t._v(" "),s("search-users",{ref:"searchUsers"})],1)},staticRenderFns:[]};var m=s("VU/8")(d,p,!1,function(t){s("rrcg")},"data-v-574112e3",null);e.default=m.exports},qyJz:function(t,e,s){"use strict";var i=s("+ZMJ"),a=s("kM2E"),n=s("sB3e"),r=s("msXi"),o=s("Mhyx"),c=s("QRG4"),l=s("fBQ2"),u=s("3fs2");a(a.S+a.F*!s("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,s,a,d,p=n(t),m="function"==typeof this?this:Array,v=arguments.length,f=v>1?arguments[1]:void 0,h=void 0!==f,_=0,g=u(p);if(h&&(f=i(f,v>2?arguments[2]:void 0,2)),void 0==g||m==Array&&o(g))for(s=new m(e=c(p.length));e>_;_++)l(s,_,h?f(p[_],_):p[_]);else for(d=g.call(p),s=new m;!(a=d.next()).done;_++)l(s,_,h?r(d,f,[a.value,_],!0):a.value);return s.length=_,s}})},rrcg:function(t,e){},sVQy:function(t,e){},srYc:function(t,e){},vm2t:function(t,e,s){"use strict";var i=s("Pi6f"),a=s("COTu"),n=s("BtDC"),r=s("9lK7"),o=s("MWCm"),c={name:"group-manager",props:{groupId:{type:[String,Number],default:null}},components:{AvatarCropper:o.a,UserBusinessCard:r.a,LaunchGroupChat:n.a},data:function(){return{tabIndex:0,loading:!1,form:{group_name:"",profile:"",avatar:""},rules:{group_name:[{required:!0,message:"用户昵称不能为空!",trigger:"blur"}]},detail:{group_name:"",profile:"",avatar:""},searchMembers:"",batchDelMember:!1,members:[],notice:{isShowform:!1,loading:!1,form:{id:0,title:"",content:""},rules:{title:[{required:!0,message:"标题不能为空!",trigger:"blur"}],content:[{required:!0,message:"详情不能为空",trigger:"blur"}]},items:[]},inviteFriendBox:!1,isAvatarCropper:!1}},computed:{filterMembers:function(){var t=this;return""==this.searchMembers?this.members:this.members.filter(function(e,s){return null!=e.nickname.match(t.searchMembers)||null!=e.visit_card.match(t.searchMembers)})}},created:function(){this.loadGroupDetail(),this.loadMembers(),this.loadNotices()},methods:{loadGroupDetail:function(){var t=this;Object(a.g)({group_id:this.groupId}).then(function(e){if(200==e.code){var s=e.data;t.form.group_name=s.group_name,t.form.profile=s.group_profile,t.form.avatar=s.avatar,t.detail={group_name:s.group_name,profile:s.profile,avatar:s.avatar}}})},loadMembers:function(){var t=this;Object(a.d)({group_id:this.groupId}).then(function(e){200==e.code&&(t.members=e.data.map(function(t){return t.is_delete=!1,t}))})},loadNotices:function(){var t=this;Object(a.e)({group_id:this.groupId}).then(function(e){200==e.code&&(t.notice.items=e.data.map(function(t){return t.isShow=!1,t}))})},editGroup:function(){var t=this;this.$refs.groupForm.validate(function(e){if(!e)return!1;t.loading=!0,Object(a.b)({group_id:t.groupId,group_name:t.form.group_name,group_profile:t.form.profile,avatar:t.form.avatar}).then(function(e){200==e.code?(t.detail.group_name=t.form.group_name,t.detail.profile=t.form.profile,t.detail.avatar=t.form.avatar,t.$message({message:"信息修改成功...",type:"success"})):t.$message("信息修改失败...")}).finally(function(){t.loading=!1})})},close:function(){this.$emit("close")},triggerTab:function(t){this.tabIndex=t},closeAvatarCropper:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.isAvatarCropper=!1,1==t&&""!=e&&(this.form.avatar=e)},showNoticeBox:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.notice.isShowform=!0,this.notice.form.id=t,this.notice.form.title=e,this.notice.form.content=s},onSubmitNotice:function(){var t=this;this.$refs.noticeForm.validate(function(e){if(!e)return!1;t.notice.loading=!0,Object(a.c)({notice_id:t.notice.form.id,group_id:t.groupId,title:t.notice.form.title,content:t.notice.form.content}).then(function(e){200==e.code?(t.notice.isShowform=!1,t.loadNotices(),t.$notify({title:"消息提示",message:t.notice.form.id?"群公告修改成功...":"群公告添加成功...",position:"bottom-right",type:"success"})):t.$notify({title:"消息提示",message:t.notice.form.id?"群公告修改失败...":"群公告添加失败...",position:"bottom-right",type:"success"})}).catch(function(e){t.$notify({title:"消息提示",message:"网络异常，请稍后再试...",position:"bottom-right",type:"warning"})}).finally(function(){t.notice.loading=!1})})},catNoticeDetail:function(t){this.notice.items[t].isShow=!this.notice.items[t].isShow},catUserDetail:function(t){this.$refs.userBusinessCard.open(t.user_id)},triggerDelBtn:function(t){var e=this.members.findIndex(function(e){return e.id==t.id});this.members[e].is_delete=!this.members[e].is_delete},deleteMembers:function(){var t=this,e=[],s=[];this.members.forEach(function(t){t.is_delete&&(e.push(t.user_id),s.push(t.nickname))}),0!=e.length?this.$confirm("您确定要将【 "+s.join("、")+"】移出群聊?","温馨提示",{confirmButtonText:"确定删除",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,customClass:"border-radius0"}).then(function(){Object(a.i)({group_id:t.groupId,members_ids:e}).then(function(e){200==e.code&&(t.loadMembers(),t.$notify({title:"删除成功",message:"已成功将群成员移除群组...",type:"success"}))})}).catch(function(){t.members.map(function(t){return t.is_delete=!1}),t.batchDelMember=!1}):this.batchDelMember=!1},inviteSuccess:function(){this.inviteFriendBox=!1,this.loadMembers()}}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"base-mask"},[s("div",{staticClass:"container"},[s("el-container",{staticClass:"hv100"},[s("el-header",{staticClass:"padding0 header no-select",attrs:{height:"50px"}},[s("span",[t._v("群管理【"+t._s(t.detail.group_name)+"】")]),t._v(" "),s("i",{staticClass:"close-btn el-icon-close",on:{click:t.close}})]),t._v(" "),s("el-main",{staticClass:"main padding0"},[s("el-container",{staticClass:"hv100"},[s("el-aside",{staticClass:"aside-border no-select",attrs:{width:"100px"}},[s("div",{staticClass:"menu-list",class:{"menu-list-selectd":0==t.tabIndex},on:{click:function(e){return t.triggerTab(0)}}},[t._v("群信息")]),t._v(" "),s("div",{staticClass:"menu-list",class:{"menu-list-selectd":1==t.tabIndex},on:{click:function(e){return t.triggerTab(1)}}},[t._v("群成员")]),t._v(" "),s("div",{staticClass:"menu-list",class:{"menu-list-selectd":2==t.tabIndex},on:{click:function(e){return t.triggerTab(2)}}},[t._v("群公告")]),t._v(" "),s("div",{staticClass:"menu-list",class:{"menu-list-selectd":3==t.tabIndex},on:{click:function(e){return t.triggerTab(3)}}},[t._v("群设置")])]),t._v(" "),0==t.tabIndex?s("el-main",[s("el-row",[s("el-col",{attrs:{span:14}},[s("el-form",{ref:"groupForm",attrs:{model:t.form,rules:t.rules}},[s("el-form-item",{attrs:{label:"群名:",prop:"group_name"}},[s("el-input",{attrs:{size:"medium",placeholder:"请输入群名称",maxlength:"30","show-word-limit":""},model:{value:t.form.group_name,callback:function(e){t.$set(t.form,"group_name",e)},expression:"form.group_name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"群描述:"}},[s("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入群描述"},model:{value:t.form.profile,callback:function(e){t.$set(t.form,"profile",e)},expression:"form.profile"}})],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small",loading:t.loading},on:{click:t.editGroup}},[t._v("\n                      修改信息")])],1)],1)],1),t._v(" "),s("el-col",{staticClass:"avatar-col",attrs:{span:10}},[s("div",{staticClass:"avatar-box"},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.form.avatar,expression:"form.avatar"}],attrs:{src:t.form.avatar}}),t._v(" "),s("div",{staticClass:"upload-icon"},[s("i",{staticClass:"el-icon-upload"})]),t._v(" "),s("div",{staticClass:"upload-mask",on:{click:function(e){t.isAvatarCropper=!0}}},[s("i",{staticClass:"el-icon-plus"})])]),t._v(" "),s("p",{staticStyle:{"margin-top":"20px"}},[t._v("设置头像")])])],1)],1):1==t.tabIndex?s("el-main",{staticClass:"padding0"},[s("el-container",{staticClass:"hv100"},[s("el-header",{staticClass:"notice-header",attrs:{height:"50px"}},[s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索群成员 ( 共"+t.members.length+"人 )",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:t.searchMembers,callback:function(e){t.searchMembers=e},expression:"searchMembers"}}),t._v(" "),s("p",[s("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.inviteFriendBox=!0}}},[t._v("\n                    邀请好友\n                  ")]),t._v(" "),t.batchDelMember?s("el-button",{attrs:{size:"small",icon:"el-icon-delete",type:"danger"},on:{click:t.deleteMembers}},[t._v("\n                    确认删除\n                  ")]):s("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-finished"},on:{click:function(e){t.batchDelMember=!0}}},[t._v("\n                    批量操作\n                  ")])],1)],1),t._v(" "),s("el-main",{staticClass:"padding0"},[s("el-scrollbar",{staticClass:"hv100",attrs:{native:!1,tag:"section"}},[s("div",{staticClass:"members"},t._l(t.filterMembers,function(e,i){return s("div",{key:e.user_id,staticClass:"member no-select",class:{"member-selectd":e.is_delete&&t.batchDelMember}},[s("div",{staticClass:"item-header"},[s("div",{staticClass:"avatar",on:{click:function(s){return t.catUserDetail(e)}}},[s("el-avatar",{attrs:{size:30,src:e.avatar}},[s("img",{attrs:{src:"/static/image/detault-avatar.jpg",alt:""}})]),t._v(" "),s("span",{staticClass:"nickname",domProps:{textContent:t._s(e.nickname)}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.is_manager,expression:"member.is_manager"}],staticClass:"larkc-tag"},[t._v("群主")])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.batchDelMember&&!e.is_manager,expression:"batchDelMember && !member.is_manager"}],staticClass:"tools"},[s("i",{staticClass:"el-icon-success",class:{"is-delete":e.is_delete},on:{click:function(s){return s.stopPropagation(),t.triggerDelBtn(e)}}})])]),t._v(" "),s("div",{staticClass:"profile"},[t._v("签名 | "+t._s(e.motto?e.motto:"未设置"))])])}),0)])],1)],1)],1):2==t.tabIndex?s("el-main",{staticClass:"padding0"},[s("el-container",{staticClass:"hv100"},[s("el-header",{staticClass:"notice-header",staticStyle:{"padding-left":"14px"},attrs:{height:"50px"}},[s("span",[t._v("群公告 ("+t._s(t.notice.items.length)+")")]),t._v(" "),s("el-button",{attrs:{plain:"",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.showNoticeBox(0,"","")}}},[t._v("\n                  添加公告\n                ")])],1),t._v(" "),s("el-main",{staticClass:"padding0"},[s("el-scrollbar",{staticClass:"hv100",attrs:{native:!1,tag:"section"}},[0==t.notice.items.length?s("div",{staticClass:"empty-notice"},[s("svg-icon",{staticStyle:{width:"80px"},attrs:{"icon-class":"not-data"}}),t._v(" "),s("span",[t._v("暂无群公告")])],1):s("div",{staticClass:"notices"},t._l(t.notice.items,function(e,i){return s("div",{key:e.id,staticClass:"notice"},[s("div",{staticClass:"title"},[s("span",{staticClass:"left-title",domProps:{textContent:t._s(e.title)},on:{click:function(s){return t.showNoticeBox(e.id,e.title,e.content)}}}),t._v(" "),s("span",{staticClass:"right-tools no-select",on:{click:function(e){return t.catNoticeDetail(i)}}},[t._v(t._s(e.isShow?"收起":"展开"))])]),t._v(" "),s("p",{staticClass:"datetime"},[s("el-avatar",{attrs:{size:15,src:e.avatar}},[s("img",{attrs:{src:"/static/image/detault-avatar.jpg",alt:""}})]),t._v(" "),s("span",{staticClass:"text nickname",domProps:{textContent:t._s(e.nickname)},on:{click:function(s){return t.$refs.userBusinessCard.open(e.user_id)}}}),t._v(" "),s("span",{staticClass:"text"},[t._v("发表于 "+t._s(e.created_at))])],1),t._v(" "),s("p",{staticClass:"content",class:{retract:!e.isShow},domProps:{textContent:t._s(e.content)}})])}),0)])],1)],1)],1):3==t.tabIndex?s("el-main",{staticClass:"padding0"}):t._e()],1)],1)],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.notice.isShowform,expression:"notice.isShowform"}],staticClass:"base-mask animated fadeIn"},[s("div",{staticClass:"notice-box"},[s("h4",[t._v("编辑群公告")]),t._v(" "),s("el-form",{ref:"noticeForm",attrs:{model:t.notice.form,rules:t.notice.rules}},[s("el-form-item",{attrs:{label:"标题",prop:"title"}},[s("el-input",{attrs:{size:"medium",placeholder:"请输入标题...",maxlength:"30","show-word-limit":""},model:{value:t.notice.form.title,callback:function(e){t.$set(t.notice.form,"title",e)},expression:"notice.form.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"详情",prop:"content"}},[s("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请输入公告详情...",maxlength:"500"},model:{value:t.notice.form.content,callback:function(e){t.$set(t.notice.form,"content",e)},expression:"notice.form.content"}})],1),t._v(" "),s("el-form-item",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{plain:"",size:"small"},on:{click:function(e){t.notice.isShowform=!1}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small",loading:t.notice.loading},on:{click:t.onSubmitNotice}},[t._v("提交")])],1)],1)],1)]),t._v(" "),t.isAvatarCropper?s("avatar-cropper",{on:{close:t.closeAvatarCropper}}):t._e(),t._v(" "),s("user-business-card",{ref:"userBusinessCard"}),t._v(" "),t.inviteFriendBox?s("launch-group-chat",{attrs:{"group-id":t.groupId},on:{close:function(e){t.inviteFriendBox=!1},"invite-success":t.inviteSuccess}}):t._e()],1)},staticRenderFns:[]};var u=s("VU/8")(c,l,!1,function(t){s("sVQy")},"data-v-e8f495cc",null).exports,d=s("2Jft"),p={name:"user-group",components:{LaunchGroupChat:n.a,UserBusinessCard:r.a,GroupManager:u,GroupNotice:d.a},props:{groupId:{type:[String,Number],default:null}},data:function(){return{detail:{groupAvatar:"",groupId:0,groupName:"",groupOwner:"",groupProfile:"",disturb:0,no_message:!1,visitCard:"",is_manager:!1,group_notice:[]},keywords:"",members:[],isEditRemark:!1,editRemarkText:"",inviteFriendBox:!1,isShowSignout:!1,signoutStatus:0,disturbDisabled:!1,isShowManager:!1,isShowGroupNotice:!1}},watch:{groupId:function(t,e){t>0&&(this.loadGroupDetail(),this.loadMembers())}},computed:{searchs:function(){var t=this;return""==this.keywords?this.members:this.members.filter(function(e,s){return null!=e.nickname.match(t.keywords)||null!=e.visit_card.match(t.keywords)})}},created:function(){parseInt(this.groupId)>0&&(this.loadGroupDetail(),this.loadMembers())},methods:{loadMembers:function(){var t=this;Object(a.d)({group_id:this.groupId}).then(function(e){200==e.code&&(t.members=e.data,t.$emit("group-info",{group_id:t.members.groupId,members_num:t.members.length}))})},loadGroupDetail:function(){var t=this;this.isEditRemark=!1,Object(a.g)({group_id:this.groupId}).then(function(e){if(200==e.code){var s=e.data;t.detail.groupAvatar=s.avatar,t.detail.groupId=s.group_id,t.detail.userId=e.data.user_id,t.detail.groupName=s.group_name,t.detail.groupOwner=s.manager_nickname,t.detail.groupProfile=s.group_profile,t.detail.disturb=1==s.not_disturb,t.detail.visitCard=s.visit_card,t.detail.is_manager=s.is_manager,t.detail.group_notice=s.notice}})},editDisturb:function(t){var e=this;this.disturbDisabled=!0,Object(i.o)({type:2,receive_id:this.groupId,not_disturb:t?1:0}).then(function(s){200==s.code?e.$emit("disturb-change",{group_id:e.groupId,status:t?1:0}):e.detail.disturb=t?0:1}).catch(function(s){e.detail.disturb=t?0:1}).finally(function(){e.disturbDisabled=!1})},editRemark:function(){var t=this;""!=this.editRemarkText&&this.detail.visitCard!=this.editRemarkText?Object(a.k)({group_id:this.groupId,visit_card:this.editRemarkText}).then(function(e){200==e.code&&(t.isEditRemark=!1,t.detail.visitCard=t.editRemarkText)}):this.isEditRemark=!1},openUserDetail:function(t){this.$refs.userBusinessCard.open(t)},addGroupMembers:function(){sessionStorage.setItem("invite_group_id",this.detail.groupId),this.inviteFriendBox=!0},inviteSuccess:function(){this.inviteFriendBox=!1,this.loadMembers(),this.$notify({title:"邀请成功",message:"好友已成功加入群组...",type:"success"})},sendGroup:function(){this.$emit("send-group",this.detail.groupId)},signout:function(){var t=this;this.signoutStatus=1,Object(a.j)({group_id:this.detail.groupId}).then(function(e){200==e.code?(t.signoutStatus=3,setTimeout(function(){t.signoutStatus=0,t.isShowSignout=!1,t.$emit("quit-group")},1500)):(t.signoutStatus=2,setTimeout(function(){t.signoutStatus=0},3e3))}).catch(function(e){t.signoutStatus=2,setTimeout(function(){t.signoutStatus=0},3e3)})}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",{staticClass:"container"},[s("el-header",{staticClass:"header"},[s("span",[t._v("群信息")]),t._v(" "),s("el-tooltip",{attrs:{content:"发送消息",placement:"top"}},[s("i",{staticClass:"send-message el-icon-chat-dot-square",on:{click:t.sendGroup}})]),t._v(" "),s("i",{staticClass:"close-btn el-icon-close",on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),s("el-main",{staticClass:"main lm-scrollbar"},[s("div",{staticClass:"list-item list-item-flex"},[s("p",[s("span",[t._v("群名称：")]),t._v(" "),s("span",{staticClass:"group-setting-title"},[t._v(t._s(t.detail.groupName))])]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.detail.is_manager,expression:"detail.is_manager"}],staticClass:"more",on:{click:function(e){t.isShowManager=!0}}},[t._v("管理")])]),t._v(" "),s("div",{staticClass:"list-item"},[s("span",[t._v("群主：")]),t._v(" "),s("span",{staticClass:"group-boss-name"},[t._v(t._s(t.detail.groupOwner))])]),t._v(" "),s("div",{staticClass:"list-item"},[s("span",[t._v("我的群昵称：")]),t._v(" "),t.isEditRemark?s("span",[s("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.editRemarkText,expression:"editRemarkText"}],staticClass:"edit-input",attrs:{type:"text"},domProps:{value:t.editRemarkText},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.editRemark(e)},input:function(e){e.target.composing||(t.editRemarkText=e.target.value)}}}),t._v(" "),s("span",{staticClass:"input-submit",on:{click:t.editRemark}},[t._v("确认")])]):s("span",{staticClass:"edit-visit-card"},[s("span",[t._v("\n          "+t._s(t.detail.visitCard)+"\n          "),s("span",{directives:[{name:"show",rawName:"v-show",value:!t.detail.visitCard,expression:"!detail.visitCard"}],staticStyle:{"font-size":"12px"}},[t._v("添加群名片")])]),t._v(" "),s("i",{staticClass:"el-icon-edit-outline edit-remark-icon",on:{click:function(e){t.isEditRemark=!0,t.editRemarkText=t.detail.visitCard}}})])]),t._v(" "),s("div",{staticClass:"list-item list-item-flex"},[s("span",[t._v("消息免打扰：")]),t._v(" "),s("el-switch",{attrs:{disabled:t.disturbDisabled,"inactive-color":"#e0d6d6"},on:{change:t.editDisturb},model:{value:t.detail.disturb,callback:function(e){t.$set(t.detail,"disturb",e)},expression:"detail.disturb"}})],1),t._v(" "),s("div",{staticClass:"list-item"},[s("span",[t._v("群成员：")]),t._v(" "),s("span",[t._v(t._s(t.members.length)+" 人")])]),t._v(" "),s("div",{staticClass:"list-item-tips"},[t._v("群主已开启“新成员入群可查看所有聊天记录”")]),t._v(" "),s("div",{staticClass:"list-item"},[s("span",[t._v("群简介")])]),t._v(" "),s("div",{staticClass:"list-item-tips"},[t._v(t._s(t.detail.groupProfile?t.detail.groupProfile:"暂无群简介"))]),t._v(" "),s("div",{staticClass:"list-item list-item-flex"},[s("span",[t._v("群公告")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.detail.group_notice,expression:"detail.group_notice"}],staticClass:"more",on:{click:function(e){t.isShowGroupNotice=!0}}},[t._v("更多")])]),t._v(" "),s("div",{staticClass:"list-item-tips group-notice"},[t.detail.group_notice.title?s("span",[s("b",[t._v("#"+t._s(t.detail.group_notice.title)+"#")]),s("br"),t._v(" "+t._s(t.detail.group_notice.content)+"\n      ")]):s("span",[t._v("暂无群公告")])]),t._v(" "),s("div",{staticClass:"list-item no-select"},[s("p",{staticClass:"group-invite",on:{click:t.addGroupMembers}},[s("i",{staticClass:"el-icon-plus"}),t._v(" "),s("span",[t._v("邀请好友")])])]),t._v(" "),s("div",{staticClass:"list-item"},[s("div",{staticClass:"member-box"},[s("div",{staticClass:"member-view-box"},[s("i",{staticClass:"iconfont icon-sousuo i-sousuo"}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.keywords,expression:"keywords"}],attrs:{type:"text",placeholder:"搜索群成员"},domProps:{value:t.keywords},on:{input:function(e){e.target.composing||(t.keywords=e.target.value)}}})]),t._v(" "),s("el-row",{staticClass:"row-header"},[s("el-col",{attrs:{span:11}},[t._v("昵称")]),t._v(" "),s("el-col",{attrs:{span:8}},[t._v("名片")]),t._v(" "),s("el-col",{attrs:{span:5}},[t._v("性别")])],1),t._v(" "),t._l(t.searchs,function(e,i){return s("el-row",{key:e.user_id,staticClass:"row-items",nativeOn:{click:function(s){return t.openUserDetail(e.user_id)}}},[s("el-col",{attrs:{span:11}},[s("img",{attrs:{src:e.avatar,onerror:t.$store.state.detaultAvatar,width:"20px"}}),t._v(" "),s("span",{staticClass:"nickname"},[t._v(t._s(e.nickname))])]),t._v(" "),s("el-col",{attrs:{span:8}},[s("span",[t._v(t._s(e.visit_card?e.visit_card:"-"))])]),t._v(" "),s("el-col",{attrs:{span:5}},[1==e.gender?s("span",[t._v("男")]):2==e.gender?s("span",[t._v("女")]):s("span",[t._v("未知")])])],1)})],2)])]),t._v(" "),s("el-footer",{staticClass:"footer"},[s("button",{on:{click:function(e){t.isShowSignout=!0}}},[t._v("退出该群聊")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSignout,expression:"isShowSignout"}],staticClass:"signout-box no-select"},[s("p",{directives:[{name:"show",rawName:"v-show",value:0==t.signoutStatus,expression:"signoutStatus == 0"}]},[t._v("您确认退出当前群聊吗？")]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:0==t.signoutStatus,expression:"signoutStatus == 0"}]},[t._v("退群后群聊信息将不能查看")]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:0==t.signoutStatus,expression:"signoutStatus == 0"}],staticClass:"signout-btn"},[s("button",{on:{click:t.signout}},[t._v("确认")]),t._v(" "),s("button",{on:{click:function(e){t.isShowSignout=!1}}},[t._v("取消")])]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:1==t.signoutStatus,expression:"signoutStatus == 1"}],staticClass:"signout-btn mt38"},[s("span",{staticStyle:{color:"rgb(123, 212, 255)"}},[s("i",{staticClass:"iconfont icon-jiazaizhong lm-icon-spin"}),t._v(" 正在退出群聊...\n      ")])]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:2==t.signoutStatus,expression:"signoutStatus == 2"}],staticClass:"signout-btn mt38"},[s("span",{staticStyle:{color:"#CCCCCC"}},[t._v("退出群聊失败，请3(s)后再试...")])]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:3==t.signoutStatus,expression:"signoutStatus == 3"}],staticClass:"signout-btn mt38"},[s("span",{staticStyle:{color:"#339e19"}},[s("i",{staticClass:"iconfont icon-success_no_circle"}),t._v(" 已成功退出群聊...\n      ")])])]),t._v(" "),s("user-business-card",{ref:"userBusinessCard"}),t._v(" "),t.inviteFriendBox?s("launch-group-chat",{attrs:{"group-id":t.groupId},on:{close:function(e){t.inviteFriendBox=!1},"invite-success":t.inviteSuccess}}):t._e(),t._v(" "),t.isShowManager?s("group-manager",{attrs:{"group-id":t.groupId},on:{close:function(e){t.isShowManager=!1}}}):t._e(),t._v(" "),t.isShowGroupNotice?s("group-notice",{attrs:{"group-id":t.groupId},on:{close:function(e){t.isShowGroupNotice=!1}}}):t._e()],1)},staticRenderFns:[]};var v=s("VU/8")(p,m,!1,function(t){s("fcc9")},"data-v-9d4295a6",null);e.a=v.exports}});