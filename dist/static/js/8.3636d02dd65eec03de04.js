webpackJsonp([8],{QzoP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("MWCm"),o=a("vMJZ"),i={name:"personal-page",components:{AvatarCropper:r.a},data:function(){return{isAvatarCropper:!1,form:{nickname:"",gender:"",avatar:"",motto:"",email:"",mobile:""},rules:{nickname:[{required:!0,message:"用户昵称不能为空!",trigger:"blur"}]},loading:!1}},created:function(){this.getUserDetail()},methods:{toEmail:function(){this.$router.push({path:"/settings/security"})},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.editUserDetail()})},closeAvatarCropper:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.isAvatarCropper=!1,1==t&&""!=e&&(this.form.avatar=e)},getUserDetail:function(){var t=this;Object(o.h)().then(function(e){200==e.code&&(t.form.mobile=e.data.mobile.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),t.form.nickname=e.data.nickname,t.form.avatar=e.data.avatar,t.form.motto=e.data.motto,t.form.email=e.data.email,t.form.gender=e.data.gender)})},editUserDetail:function(){var t=this;this.loading=!0;var e=this;Object(o.e)({nickname:this.form.nickname,avatar:this.form.avatar,motto:this.form.motto,gender:this.form.gender}).then(function(e){200==e.code&&(t.$store.commit("UPDATE_USER_INFO",{nickname:t.form.nickname,sex:t.form.gender,signature:t.form.motto,avatar:t.form.avatar}),t.$message({message:"信息修改成功...",type:"success"}))}).finally(function(){e.loading=!1})}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"100%","overflow-y":"auto"}},[a("div",{staticClass:"container"},[a("h4",[t._v("设置个人信息")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:16}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[a("el-form-item",{attrs:{label:"登录账号:"}},[a("p",[t._v(t._s(t.form.mobile))])]),t._v(" "),a("el-form-item",{attrs:{label:"电子邮箱:"}},[a("p",[a("span",[t._v(t._s(t.form.email?t.form.email:"未设置邮箱"))]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"20px","font-weight":"300"},attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:t.toEmail}},[t._v(t._s(t.form.email?"修改邮箱":"设置邮箱"))])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"昵称:",prop:"nickname"}},[a("el-input",{attrs:{size:"medium",placeholder:"给自己起个名字"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别:"}},[a("el-radio-group",{model:{value:t.form.gender,callback:function(e){t.$set(t.form,"gender",e)},expression:"form.gender"}},[a("el-radio",{attrs:{label:1}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("女")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"座右铭:"}},[a("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"编辑我的座右铭..."},model:{value:t.form.motto,callback:function(e){t.$set(t.form,"motto",e)},expression:"form.motto"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium",loading:t.loading},on:{click:t.onSubmit}},[t._v("更新我的信息")])],1)],1)],1),t._v(" "),a("el-col",{staticClass:"avatar-col",attrs:{span:8}},[a("div",{staticClass:"avatar-box"},[a("img",{directives:[{name:"show",rawName:"v-show",value:t.form.avatar,expression:"form.avatar"}],attrs:{src:t.form.avatar}}),t._v(" "),a("div",{staticClass:"upload-icon"},[a("i",{staticClass:"el-icon-upload"})]),t._v(" "),a("div",{staticClass:"upload-mask",on:{click:function(e){t.isAvatarCropper=!0}}},[a("i",{staticClass:"el-icon-plus"})])]),t._v(" "),a("p",{staticStyle:{"margin-top":"20px"}},[t._v("设置头像")])])],1)],1),t._v(" "),t.isAvatarCropper?a("avatar-cropper",{on:{close:t.closeAvatarCropper}}):t._e()],1)},staticRenderFns:[]};var s=a("VU/8")(i,n,!1,function(t){a("fV1z")},"data-v-7af7cfc6",null);e.default=s.exports},fV1z:function(t,e){}});