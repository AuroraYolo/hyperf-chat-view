webpackJsonp([4],{"40DK":function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("E4LH"),i=t("vMJZ"),r={name:"change-mobile",data:function(){var e=this;return{loading:!1,form:{old_password:"",new_password:"",new_password2:""},rules:{old_password:[{required:!0,message:"旧密码不能为空!",trigger:"blur"}],new_password:[{required:!0,message:"新密码不能为空!",trigger:"blur"}],new_password2:[{required:!0,validator:function(s,t,a){""===t?a(new Error("请再次输入密码")):t!==e.form.new_password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}]},isShow:!1}},methods:{open:function(){this.$refs.form.resetFields(),this.isShow=!0},close:function(){this.isShow=!1},onSubmit:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return!1;s.changePassword()})},changePassword:function(){var e=this;this.loading=!0,Object(i.d)({old_password:this.form.old_password,new_password:this.form.new_password}).then(function(s){200==s.code?(e.$refs.form.resetFields(),e.$notify({title:"成功",message:"密码修改成功...",type:"success"})):e.$message(s.msg),e.loading=!1}).catch(function(s){e.loading=!1})}}},n={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"base-mask animated fadeIn"},[t("div",{directives:[{name:"outside",rawName:"v-outside",value:e.close,expression:"close"}],staticClass:"container"},[t("el-container",{staticClass:"hv100"},[t("el-header",{staticClass:"padding0 header",attrs:{height:"50px"}},[t("span",[e._v("修改密码")]),e._v(" "),t("i",{staticClass:"close-btn el-icon-close",on:{click:e.close}})]),e._v(" "),t("el-main",{staticClass:"main"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{prop:"old_password",label:"旧密码"}},[t("el-input",{staticClass:"cuborder-radius border0",attrs:{type:"password",placeholder:"请填写旧密码",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.old_password,callback:function(s){e.$set(e.form,"old_password",s)},expression:"form.old_password"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"new_password",label:"新密码"}},[t("el-input",{staticClass:" cuborder-radius\n              border0",attrs:{type:"password",placeholder:"请填写新的密码",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.new_password,callback:function(s){e.$set(e.form,"new_password",s)},expression:"form.new_password"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"new_password2",label:"重复密码"}},[t("el-input",{staticClass:"cuborder-radius border0",attrs:{type:"password",placeholder:"请再次填写新密码",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.new_password2,callback:function(s){e.$set(e.form,"new_password2",s)},expression:"form.new_password2"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"margin-top":"40px"}},[t("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:e.loading,size:"medium"},on:{click:function(s){return e.onSubmit("form")}}},[e._v("\n              立即修改\n            ")])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var o=t("VU/8")(r,n,!1,function(e){t("w5Ec")},"data-v-a7360170",null).exports,l=t("FRfw"),c={name:"change-mobile",data:function(){return{loading:!1,form:{username:"",password:"",sms_code:""},rules:{username:[{required:!0,validator:function(e,s,t){""===s?t(new Error("登录手机号不能为空！")):a.a.validatPhone(s)?t():t(new Error("登录手机号格式不正确！"))},trigger:"blur"},{min:11,max:11,message:"手机号格式不正确!",trigger:"blur"}],password:[{required:!0,message:"登录密码不能为空!",trigger:"blur"}],sms_code:[{required:!0,message:"验证码不能为空!",trigger:"blur"}]},smsLock:!1,smsLockObj:null,isShow:!1}},created:function(){this.smsLockObj=new l.a("FORGET_SMS",120)},destroyed:function(){clearInterval(this.smsLockObj.timer)},methods:{open:function(){this.$refs.form.resetFields(),this.isShow=!0},close:function(){this.isShow=!1},sendSms:function(){var e=this;if(!a.a.validatPhone(this.form.username))return this.$refs.form.validateField("username"),!1;this.smsLock=!0,Object(i.v)({mobile:this.form.username}).then(function(s){200===s.code?(e.smsLockObj.start(),s.data.is_debug&&(e.form.sms_code=s.data.sms_code,setTimeout(function(){e.$notify({title:"提示",message:"已自动填充验证码",type:"success"}),e.form.sms_code=s.data.sms_code},500))):e.$notify({title:"提示",message:s.msg})}).finally(function(){e.smsLock=!1})},onSubmit:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return!1;s.changeMobile()})},changeMobile:function(){var e=this;this.loading=!0,Object(i.c)({mobile:this.form.username,sms_code:this.form.sms_code,password:this.form.password}).then(function(s){200==s.code?(e.$refs.form.resetFields(),e.$notify({title:"成功",message:"更换手机号成功...",type:"success"}),e.$emit("success"),e.close()):e.$message(s.msg),e.loading=!1}).catch(function(s){e.loading=!1})}}},d={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"base-mask animated fadeIn"},[t("div",{directives:[{name:"outside",rawName:"v-outside",value:e.close,expression:"close"}],staticClass:"container"},[t("el-container",{staticClass:"hv100"},[t("el-header",{staticClass:"padding0 header",attrs:{height:"50px"}},[t("span",[e._v("绑定手机")]),e._v(" "),t("i",{staticClass:"close-btn el-icon-close",on:{click:e.close}})]),e._v(" "),t("el-main",{staticClass:"main"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{prop:"username",label:"手机号"}},[t("el-input",{staticClass:"cuborder-radius",attrs:{placeholder:"请填写新手机号",maxlength:"11",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.username,callback:function(s){e.$set(e.form,"username",s)},expression:"form.username"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"sms_code",label:"验证码"}},[t("el-input",{staticClass:"cuborder-radius",staticStyle:{width:"185px"},attrs:{placeholder:"验证码",maxlength:"6",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.sms_code,callback:function(s){e.$set(e.form,"sms_code",s)},expression:"form.sms_code"}}),e._v(" "),e.smsLock?t("div",{staticClass:"send-code-btn send-sms-disable"},[e._v("正在发送 ...")]):0==e.smsLock&&null==e.smsLockObj.time?t("div",{staticClass:"send-code-btn",on:{click:e.sendSms}},[e._v("获取短信\n            ")]):t("div",{staticClass:"send-code-btn send-sms-disable"},[e._v("重新发送("+e._s(e.smsLockObj.time)+"s)")])],1),e._v(" "),t("el-form-item",{attrs:{prop:"password",label:"密码"}},[t("el-input",{staticClass:"cuborder-radius border0",attrs:{type:"password",placeholder:"登录密码验证",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.password,callback:function(s){e.$set(e.form,"password",s)},expression:"form.password"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"margin-top":"40px"}},[t("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:e.loading,size:"medium"},on:{click:function(s){return e.onSubmit("form")}}},[e._v("\n              立即修改\n            ")])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var m={name:"change-email",data:function(){return{loading:!1,form:{email:"",password:"",sms_code:""},rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"登录密码不能为空!",trigger:"blur"}],sms_code:[{required:!0,message:"验证码不能为空!",trigger:"blur"}]},smsLock:!1,smsLockObj:null,isShow:!1}},created:function(){this.smsLockObj=new l.a("CHANGE_EMAIL_SMS",120)},destroyed:function(){clearInterval(this.smsLockObj.timer)},methods:{open:function(){this.$refs.form.resetFields(),this.isShow=!0},close:function(){this.isShow=!1},sendSms:function(){var e=this;if(!/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(this.form.email))return this.$refs.form.validateField("email"),!1;this.smsLock=!0,Object(i.u)({email:this.form.email}).then(function(s){200==s.code&&e.smsLockObj.start()}).finally(function(){e.smsLock=!1})},onSubmit:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return!1;s.changeEmail()})},changeEmail:function(){var e=this;this.loading=!0,Object(i.b)({email:this.form.email,email_code:this.form.sms_code,password:this.form.password}).then(function(s){200==s.code?(e.$refs.form.resetFields(),e.$notify({title:"成功",message:"修改邮箱成功...",type:"success"}),e.$emit("success"),e.close()):e.$message(s.msg),e.loading=!1}).catch(function(s){e.loading=!1})}}},u={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"base-mask animated fadeIn"},[t("div",{directives:[{name:"outside",rawName:"v-outside",value:e.close,expression:"close"}],staticClass:"container"},[t("el-container",{staticClass:"hv100"},[t("el-header",{staticClass:"padding0 header",attrs:{height:"50px"}},[t("span",[e._v("绑定邮箱")]),e._v(" "),t("i",{staticClass:"close-btn el-icon-close",on:{click:e.close}})]),e._v(" "),t("el-main",{staticClass:"main"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{prop:"email",label:"邮箱地址"}},[t("el-input",{staticClass:"cuborder-radius",attrs:{placeholder:"请填写邮箱地址",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.email,callback:function(s){e.$set(e.form,"email",s)},expression:"form.email"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"sms_code",label:"验证码"}},[t("el-input",{staticClass:"cuborder-radius",staticStyle:{width:"185px"},attrs:{placeholder:"邮件验证码",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.sms_code,callback:function(s){e.$set(e.form,"sms_code",s)},expression:"form.sms_code"}}),e._v(" "),e.smsLock?t("div",{staticClass:"send-code-btn send-sms-disable"},[e._v("正在发送 ...")]):0==e.smsLock&&null==e.smsLockObj.time?t("div",{staticClass:"send-code-btn",on:{click:e.sendSms}},[e._v("获取验证码\n            ")]):t("div",{staticClass:"send-code-btn send-sms-disable"},[e._v("重新发送("+e._s(e.smsLockObj.time)+"s)")])],1),e._v(" "),t("el-form-item",{attrs:{prop:"password",label:"密码"}},[t("el-input",{staticClass:"cuborder-radius border0",attrs:{type:"password",placeholder:"登录密码验证",size:"medium"},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.onSubmit("form")}},model:{value:e.form.password,callback:function(s){e.$set(e.form,"password",s)},expression:"form.password"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"margin-top":"40px"}},[t("el-button",{staticClass:"submit-btn",attrs:{type:"primary",loading:e.loading,size:"medium"},on:{click:function(s){return e.onSubmit("form")}}},[e._v("\n              立即修改\n            ")])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var f={name:"security-page",components:{ChangePassword:o,ChangeMobile:t("VU/8")(c,d,!1,function(e){t("uvAL")},"data-v-34c09094",null).exports,ChangeEmail:t("VU/8")(m,u,!1,function(e){t("PKsu")},"data-v-50dcc705",null).exports},data:function(){return{cipherStrength:"中",bindMobile:"",bindEmail:""}},created:function(){this.getUserDetail()},methods:{getUserDetail:function(){var e=this;Object(i.h)().then(function(s){200==s.code&&(e.bindMobile=s.data.mobile.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2"),e.bindEmail=s.data.email)})}}},p={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("div",{staticClass:"container"},[t("h4",[e._v("安全设置")]),e._v(" "),t("el-row",{staticClass:"list-item",attrs:{type:"flex"}},[t("el-col",{staticClass:"left-col",attrs:{span:20}},[t("h4",[e._v("账户密码")]),e._v(" "),t("p",[e._v("当前密码强度 ："+e._s(e.cipherStrength))])]),e._v(" "),t("el-col",{staticClass:"right-col",attrs:{span:4}},[t("span",{staticClass:"action",on:{click:function(s){return e.$refs.changePasswrodRef.open()}}},[e._v("修改")])])],1),e._v(" "),t("el-row",{staticClass:"list-item",attrs:{type:"flex"}},[t("el-col",{staticClass:"left-col",attrs:{span:20}},[t("h4",[e._v("绑定手机")]),e._v(" "),t("p",[e._v("已绑定手机 ："+e._s(e.bindMobile))])]),e._v(" "),t("el-col",{staticClass:"right-col",attrs:{span:4}},[t("span",{staticClass:"action",on:{click:function(s){return e.$refs.changeMobileRef.open()}}},[e._v("更换")])])],1),e._v(" "),t("el-row",{staticClass:"list-item",attrs:{type:"flex"}},[t("el-col",{staticClass:"left-col",attrs:{span:20}},[t("h4",[e._v("绑定邮箱")]),e._v(" "),t("p",[e._v("已绑定邮箱 ："+e._s(e.bindEmail))])]),e._v(" "),t("el-col",{staticClass:"right-col",attrs:{span:4}},[t("span",{staticClass:"action",on:{click:function(s){return e.$refs.changeEmailRef.open()}}},[e._v("修改")])])],1)],1),e._v(" "),t("change-password",{ref:"changePasswrodRef"}),e._v(" "),t("change-mobile",{ref:"changeMobileRef",on:{success:e.getUserDetail}}),e._v(" "),t("change-email",{ref:"changeEmailRef",on:{success:e.getUserDetail}})],1)},staticRenderFns:[]};var h=t("VU/8")(f,p,!1,function(e){t("BC+h")},"data-v-6d74ceec",null);s.default=h.exports},"BC+h":function(e,s){},PKsu:function(e,s){},uvAL:function(e,s){},w5Ec:function(e,s){}});